<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Almac√©n de Desarrollos</title>

  <link rel="icon" href="img/favicon-square-64x64-fixed.png" type="image/png" sizes="64x64">



  <!-- Tipograf√≠a Archivo (Manual GCBA) -->
  <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- CSS externo -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- AppBar / Marca GCBA -->
  <header class="appbar" aria-label="Barra superior">
    <div class="brand" aria-label="Marca GCBA">
      <div class="brand-logo" aria-hidden="true">
        <img src="https://www.estadisticaciudad.gob.ar/eyc/wp-content/uploads/2024/07/logo-BA-Azul.png" alt="">
      </div>
      <div class="brand-title">Almac√©n de desarrollos</div>
    </div>
    <div class="toolbar">
      <button class="btn btn-secondary" id="btnNewWorld" title="Crear nueva carpeta">+ Carpeta</button>
      <button class="btn btn-secondary" id="btnNewSubWorld" title="Crear sub-carpeta">+ Sub-carpeta</button>
      <button class="btn btn-ghost" id="btnBack" title="Volver">Volver</button>
      <button class="btn btn-ghost" id="btnAdmin" title="Panel de control">Panel de control</button>
      <button class="btn btn-info" id="btnStorageStatus" title="Estado del almacenamiento" style="display: none;">üíæ Estado</button>
      <button class="btn btn-danger" id="btnLogout" title="Cerrar sesi√≥n">Cerrar sesi√≥n</button>
    </div>
  </header>

  <!-- Loader Global -->
  <div id="globalLoader" class="global-loader" style="display: none;">
    <div class="loader-content">
      <div class="loader-spinner"></div>
      <div class="loader-text">Cargando...</div>
    </div>
  </div>

  <main class="container" id="app" role="main">
    <!-- HERO -->
    <section class="hero" id="hero" aria-label="Cabecera">
      <h1 id="heroTitle" class="t-title">Bienvenido</h1>
      <p id="heroDesc" class="t-bajada">Ingres√° con tu usuario para explorar las carpetas autorizadas.</p>
      <nav class="nav-pills" id="breadcrumbs" aria-label="Ruta de navegaci√≥n"></nav>
    </section>

    <!-- SECCI√ìN AUTH -->
    <section id="authSection" class="active" aria-label="Autenticaci√≥n">
      <div class="auth-card" id="loginCard" role="region" aria-labelledby="loginTitle">
        <h2 id="loginTitle" class="t-title" style="margin:0 0 12px; color:var(--ba-off);">Ingresar</h2>
        <div class="field">
          <label for="loginUser">Usuario</label>
          <input id="loginUser" placeholder="ej: admin" autocomplete="username">
        </div>
        <div class="field">
          <label for="loginPass">Contrase√±a</label>
          <input id="loginPass" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
        </div>
        <div class="form-actions">
          <button class="btn btn-primary" id="doLogin">Ingresar</button>
        </div>
        <p id="authMsg" class="t-body muted" role="status"></p>
        <div class="form-actions" style="margin-top:15px; text-align:center;">
          <button class="btn btn-ghost" id="btnInitUsers" style="font-size:12px; padding:8px 16px;">
            üîß Inicializar Usuarios
          </button>
        </div>
        <p class="t-body muted" style="margin-top:10px">
          * El alta de usuarios la realiza un ADMIN en el Panel de control.
        </p>
      </div>
    </section>

    <!-- SECCI√ìN MUNDOS -->
    <section id="worldsSection" aria-label="Carpetas">
      <h2 class="t-title section-title">Carpetas</h2>
      <div id="worldsGrid" class="grid cols-4"></div>
      <div id="worldsEmpty" class="empty" style="display:none">
        No hay carpetas visibles para tu usuario. Ped√≠ acceso a un ADMIN.
      </div>
    </section>

    <!-- SECCI√ìN SUB-MUNDOS -->
    <section id="subWorldsSection" aria-label="Sub-carpetas">
      <h2 class="t-title section-title">Sub-carpetas</h2>
      <div id="subWorldsGrid" class="grid cols-4"></div>
      <div id="subWorldsEmpty" class="empty" style="display:none">Esta carpeta todav√≠a no tiene sub-carpetas.</div>
    </section>

    <!-- SECCI√ìN DESARROLLOS -->
    <section id="devsSection" aria-label="Desarrollos">
      <h2 class="t-title section-title">Desarrollos</h2>

      <!-- Drag & Drop -->
      <div class="dropzone" id="dropzone" aria-label="Zona para arrastrar archivos o enlaces">
        <div class="dropzone-content">
          <div class="dropzone-icon">üìÅ</div>
          <div class="dropzone-text">
            <strong>Arrastr√° archivos aqu√≠</strong> o <strong>toc√° para seleccionar</strong>
          </div>
          <div class="dropzone-subtitle muted t-body">
            Tambi√©n pod√©s pegar enlaces desde el portapapeles
          </div>
          <button class="btn btn-ghost dropzone-button" id="dropzoneButton">
            üìÇ Explorar archivos
          </button>
        </div>
        
        <!-- Input file oculto para el explorador -->
        <input type="file" id="fileInput" accept="*/*" multiple style="display: none;">
        
        <!-- Mensaje de estado -->
        <div class="dropzone-status" id="dropzoneStatus" style="display: none;"></div>
      </div>

      <!-- Bot√≥n +Desarrollo prominente -->
      <div style="text-align: center; margin: 20px 0;">
        <button class="btn btn-primary" id="btnNewDesarrollo" style="font-size: 18px; padding: 15px 30px; background-color: #FFD700; color: #000; border: none; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">
          ‚ûï + Desarrollo
        </button>
      </div>

      <div id="devsGrid" class="grid cols-4" style="margin-top:14px"></div>
      <div id="devsEmpty" class="empty" style="display:none">A√∫n no hay desarrollos en esta sub-carpeta.</div>
    </section>

    <!-- PANEL DE CONTROL (solo ADMIN) -->
    <section id="adminSection" aria-label="Panel de control">
      <h2 class="t-title section-title">Panel de control</h2>

      <div class="admin-grid">
        <div class="card">
          <h3 class="t-title" style="font-size:clamp(18px,2.4vw,22px)">Usuarios</h3>
          <p class="t-body muted">Crear, editar y asignar permisos de mundos.</p>

          <div class="admin-actions">
            <button id="btnAddUser" class="btn btn-secondary">+ Nuevo usuario</button>
          </div>

          <div id="usersList" class="users-list"></div>
        </div>

        <div class="card">
          <h3 class="t-title" style="font-size:clamp(18px,2.4vw,22px)">Carpetas disponibles</h3>
          <p class="t-body muted">Resumen de carpetas actuales. Los permisos se asignan en cada usuario.</p>
          <div id="worldsSummary" class="worlds-summary"></div>
        </div>

        <div class="card">
          <h3 class="t-title" style="font-size:clamp(18px,2.4vw,22px)">Estado del Sistema</h3>
          <p class="t-body muted">Informaci√≥n sobre el almacenamiento y estado del servidor.</p>
          <div class="admin-actions">
            <button class="btn btn-info" id="btnStorageStatus" title="Estado del almacenamiento">
              üíæ Ver Estado del Sistema
            </button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>CREADO POR GO INNOVACI√ìN CULTURAL</footer>

  <!-- Modal (reutilizable) -->
  <div id="modal" class="modal" aria-hidden="true">
    <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal__header">
        <h3 id="modalTitle" class="t-title">T√≠tulo</h3>
        <button class="icon-btn" id="modalClose" aria-label="Cerrar">‚úï</button>
      </div>
      <div id="modalBody" class="modal__body"></div>
      <div class="modal__footer">
        <button class="btn btn-ghost" id="modalCancel">Cancelar</button>
        <button class="btn btn-primary" id="modalSubmit">Guardar</button>
      </div>
    </div>
  </div>

  <!-- Modal de Estado del Almacenamiento -->
  <div id="storageStatusModal" class="modal" aria-hidden="true">
    <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="storageStatusTitle">
      <div class="modal__header">
        <h3 id="storageStatusTitle" class="t-title">Estado del Almacenamiento</h3>
        <button class="icon-btn" id="storageStatusClose" aria-label="Cerrar">‚úï</button>
      </div>
      <div class="modal__body">
        <div class="storage-status-content">
          <div class="storage-info">
            <div class="storage-item">
              <span class="storage-label">Espacio Total:</span>
              <span class="storage-value" id="totalSpace">Calculando...</span>
            </div>
            <div class="storage-item">
              <span class="storage-label">Espacio Ocupado:</span>
              <span class="storage-value" id="usedSpace">Calculando...</span>
            </div>
            <div class="storage-item">
              <span class="storage-label">Espacio Disponible:</span>
              <span class="storage-value" id="freeSpace">Calculando...</span>
              </div>
            <div class="storage-item">
              <span class="storage-label">Porcentaje Usado:</span>
              <span class="storage-value" id="usagePercentage">Calculando...</span>
            </div>
          </div>
          <div class="storage-bar">
            <div class="storage-progress" id="storageProgress"></div>
          </div>
          <div class="storage-details">
            <h4>Detalles del Sistema</h4>
            <div class="storage-item">
              <span class="storage-label">Base de Datos:</span>
              <span class="storage-value" id="dbStatus">Conectado</span>
            </div>
            <div class="storage-item">
              <span class="storage-label">Archivos:</span>
              <span class="storage-value" id="filesCount">0</span>
            </div>
            <div class="storage-item">
              <span class="storage-label">√öltima Actualizaci√≥n:</span>
              <span class="storage-value" id="lastUpdate">-</span>
            </div>
          </div>
        </div>
      </div>
      <div class="modal__footer">
        <button class="btn btn-primary" id="refreshStorageStatus">üîÑ Actualizar</button>
        <button class="btn btn-ghost" id="closeStorageStatus">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- JS externo -->
  <script src="app.js" defer></script>
</body>
</html>
